<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <title>憑證預授權已產生</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      .qr-container {
        background-color: #fff;
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        margin: 0 auto;
        max-width: 300px;
      }
      .offer-link {
        border: 1px solid #dee2e6;
        background-color: #f8f9fa;
        font-family: monospace;
      }
      .copy-button {
        position: relative;
      }
    </style>
  </head>
  <body class="p-4">
    <div class="container text-center">
      <div class="card shadow">
        <div class="card-header bg-primary text-white">
          <h2 class="mb-0">房產憑證預授權已產生</h2>
        </div>
        <div class="card-body">
          <div class="alert alert-info">
            <p class="mb-0">
              請掃描下方 QR code 或複製連結，使用憑證錢包領取房產憑證
            </p>
          </div>

          <!-- QR code -->
          <div class="qr-container mb-4">
            <img
              src="{{ qr_path }}"
              alt="QR code"
              class="img-fluid mb-3"
              style="max-width: 220px"
            />
            <p class="text-muted mb-0">憑證編號：{{ vc_id }}</p>
          </div>

          <!-- 顯示 Credential Offer 連結 -->
          <div class="mb-3">
            <div class="input-group">
              <input
                type="text"
                class="form-control offer-link text-center"
                value="{{ offer_url }}"
                id="offerLink"
                readonly
              />
              <button
                class="btn btn-outline-primary copy-button"
                onclick="copyLink()"
              >
                <i class="bi bi-clipboard"></i> 複製連結
              </button>
            </div>
          </div>

          <div class="alert alert-warning">
            <strong>注意：</strong> 此連結有效期為 24
            小時，請在期限內使用憑證錢包領取
          </div>
        </div>

        <!-- 統一導航區 -->
        <div class="card-footer">
          <div class="d-flex justify-content-center gap-2">
            <a href="/" class="btn btn-secondary">首頁</a>
            <a href="/property/{{ session_id }}" class="btn btn-secondary"
              >房產列表</a
            >
            <a href="/issued" class="btn btn-secondary">已核發清單</a>
          </div>
        </div>
      </div>
    </div>

    <script>
      function copyLink() {
        const input = document.getElementById("offerLink");
        input.select();
        input.setSelectionRange(0, 99999); // For mobile
        navigator.clipboard.writeText(input.value).then(() => {
          alert("連結已複製到剪貼簿！");
        });
      }
    </script>
  </body>
</html>
